---
user-invocable: false
description: "devenv (Nix) manages all packages, services, and toolchains. Load for: missing commands, package install/search, language/service config, editing devenv.nix."
---

# devenv — how to make changes

Do not install packages with apt, brew, pip, npm -g, or similar. Everything goes through `devenv.nix`.

## Missing command or package

1. Search for the package:

```bash
bash .claude/skills/devenv/scripts/search-packages.sh "<query>"
```
2. Edit `devenv.nix`: add the package name to the `packages` list
3. Tell the user to re-enter the devenv shell (or `direnv reload`)

## Enable a language toolchain

Edit `devenv.nix`, add:

```nix
languages.<name>.enable = true;
```

Common: `python`, `rust`, `go`, `javascript`, `typescript`. For version or package overrides, search options first.

## Enable a service

Edit `devenv.nix`, add:

```nix
services.<name>.enable = true;
```

Common: `postgres`, `redis`, `mysql`, `elasticsearch`. Service-specific settings vary — search options to discover them.

## Search available options

```bash
bash .claude/skills/devenv/scripts/search-options.sh "<query>"
```

## Show current value of an option

```bash
bash .claude/skills/devenv/scripts/show-option.sh "<option.path>"
```

## Add a script

Edit `devenv.nix`, add:

```nix
scripts.<name>.exec = ''
  your shell commands here
'';
```

## After any change to devenv.nix

Always tell the user they must re-enter the devenv shell or run `direnv reload` to pick up changes.

## Files you must not edit

- `.devenv.flake.nix` — generated, never edit
- `devenv.lock` — managed by devenv, do not hand-edit
- `.claude/settings.json` — generated by `claude.code.settings` in devenv.nix; edit devenv.nix instead

## Nix syntax help

Read `reference.md` in this skill directory before editing `devenv.nix` if you are unsure about Nix syntax or option patterns.
